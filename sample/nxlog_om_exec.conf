<Output msteams>
    Module om_exec
    Command /usr/local/bin/mst-sender
    Arg --title
    Arg My awesome log monitoring
    Exec    if not ($raw_event =~ /error/i) drop();
</Output>

<Processor removeDate>
    Module pm_null
    <Exec>
        if ($raw_event =~ /\[.*?\] (.*)/) $raw_event = $1;
    </Exec>
</Processor>

<Processor norepeat>
  Module pm_null
  <Exec>
  if defined get_stat($raw_event) {
    add_stat($raw_event, 1);
  }
  else {
    create_stat($raw_event, 'COUNT', 10, now(), 10);
  }
  if get_stat($raw_event) > 2 drop();
  </Exec>
</Processor>

<Input applog>
    Module im_file
    File "/tmp/app.log"
    <Exec>
      $raw_event = "[File=/tmp/app.log]" + $raw_event;
    </Exec>
</Input>
<Input serverlog>
    Module im_file
    File "/tmp/server.log"
    <Exec>
       if not ($raw_event =~ /exception/i) drop();
       $raw_event = "[File=/tmp/server.log]" + $raw_event;
    </Exec>
</Input>
<Route myLogging>
    Path applog,serverlog => removeDate => norepeat => msteams
</Route>